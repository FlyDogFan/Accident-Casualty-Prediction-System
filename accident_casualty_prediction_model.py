# -*- coding: utf-8 -*-
"""Accident Casualty Prediction Model.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1RgHiM6QjHwP-at0cuWiwVvbyLk16wuPC
"""

#Accident Casualty Prediction Model

import pandas as pd
data= pd.read_csv('https://trello-attachments.s3.amazonaws.com/5cf2142046ceb163a0e4b189/5cf4e21e143159856a320b36/e353326f944665ae8a979a0573a8f9fa/Accident_Dataset_prepared.csv')
data

data.columns

Y = data["Casualty Severity"]#dependent variable
independent_variables = data.columns
independent_variables = independent_variables.delete(5)
data1 = data[independent_variables]#independent variables
data1

#Perform Clustering to preapre a clustered dataset
from sklearn.cluster import AgglomerativeClustering
agg_cluster = AgglomerativeClustering(n_clusters = 3)

#Trainig the agglomerative clustering model
agg_cluster.fit(data1)

#predict the cluster label
data["Cluster Labels"] = agg_cluster.fit_predict(data1)
data

# Select dependent and independent variables
Y = data["Casualty Severity"]
independent_variables = data.columns
independent_variables = independent_variables.delete(5)
X = data[independent_variables]

#Classify using Gradient Boost Trees

from sklearn.ensemble import GradientBoostingClassifier
gbc = GradientBoostingClassifier()

#Train the model
gbc.fit(X , Y)

data["Predicted Casualty Severity"] = gbc.predict(X)
data

independent_variables = independent_variables.delete(8)

#Take User input and Prdict Casualty
user_input = {}
for var in independent_variables:
  temp = input("Enter 1" +var+ ":")
  user_input[var]  = temp

#Calculate the cluster label
index = data1.shape[0]
user_df = pd.DataFrame(data = user_input , index = [index] , columns = independent_variables )
data1 = pd.concat([data1 , user_df] , axis = 0) #add a new row in data1

data1["Cluster Labels"] = agg_cluster.fit_predict(data1)
data1.tail(3)

user_request = data1.tail(1)
severity = gbc.predict(user_request)
severity = severity[0]
if severity == 1:
  print("Casualty Severity is Slight (%d)" % severity)
elif severity == 2:
  print("Casualty Severity is Severe (%d)" % severity)
elif severity == 3:
  print("Casualty Severity is Fatal (%d)" % severity)

